# Spend Lens
Spending analysis app for Montenegro. Why Montenegro? Because the fiscal recipes in the contry have an obligatory QR code that leads to the page with most of the information about the purchase: place, time, line items, tax information, and totals.

**The app is work-in-progress** and most of the functionality is not there yet. The repo contains only the skeleton. 

### Installation and set up

* Install rust with cargo
* Run cargo in all packages
* Run migrations
* Start background workers
* Start the main server
* IDE of choice - android studio with Rust plugin

## App structure
The app consists of the several semi-independent packages:

* The **app** package contains most of the domain logic - checking invoice urls and downloading line items
* The **app_config** package stores app-wide configuration in a series of `.yml` files
* The **background_jobs** package is responsible for executing asynchronous tasks
* The **entities** folder is generated by the `sea-orm-cli` command and represents all the "models"
* The **migration** package is an another part of `sea-orm` and contains all migrations
* The **web_app** package contains actix server with endpoints for the web app and mobile applications

### App Config

The package contains a library that holds the application config

### Entities

Entities package describes the database schema. It is generated by the `sea-orm-cli` command.

### Migrations

**migration** is a separate application that wraps `sea-orm` migrations. It uses the settings from the `app_config` to apply migrations for a given database and environment.

### Background jobs

The `background_jobs` crate is a separate application that runs background jobs. It uses the settings from the `app_config` to connect to the database.

### Web app

The `web_app` crate is the main application that runs the server. It orchestrates the other crates and provides the HTTP API.